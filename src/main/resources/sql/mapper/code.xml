<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.iwi.iwms.api.code.mapper.CodeMapper">

	<!-- 코드별 하위 코드 목록 조회 -->	
	<select id="listCodeByUpCode" parameterType="String"
		resultType="com.iwi.iwms.api.code.domain.CodeInfo">
		SELECT 
			CODE.CODE_CD AS codeCd
			, CODE.CODE_NM AS codeNm
		FROM TB_CODE CODE
		WHERE CODE.USE_YN = 'Y'	
			AND CODE.UP_CODE_CD = #{codeCd}
		ORDER BY CODE.CODE_SEQ
	</select>

	<!-- 공통 코드 등록 -->	
	<insert id="insertCode" parameterType="com.iwi.iwms.api.code.domain.Code"
		useGeneratedKeys="true" keyProperty="codeSeq">
		INSERT INTO TB_CODE
		(
		    CODE_CD
		    , CODE_NM
			, UP_CODE_CD
			, USE_YN
			, REG_SEQ
		) VALUES (
		    #{codeCd}
			, #{codeNm}
			, #{upCodeCd}
			, #{useYn}
			, #{loginUserSeq}
		)		
	</insert>		

	<!-- 공통 코드 수정 -->
	<update id="updateCode" parameterType="com.iwi.iwms.api.code.domain.Code">
		UPDATE TB_CODE 
		SET
		    CODE_CD = #{codeCd}
		    , CODE_NM = #{codeNm}
			, UP_CODE_CD = #{upCodeCd}
			, USE_YN = #{useYn}
			, UPT_DT = CURRENT_TIMESTAMP
			, UPT_SEQ = #{loginUserSeq}
		WHERE CODE_SEQ = #{codeSeq}	
	</update>	

	<!-- 공통 코드 삭제 -->	
	<delete id="deleteCode" parameterType="com.iwi.iwms.api.code.domain.Code">
		DELETE 
		FROM TB_CODE
		WHERE CODE_SEQ = #{codeSeq}	 
	</delete>
		
</mapper>